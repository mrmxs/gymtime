-- C–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö 'gymtime' --

/*
 * gyms
 * news
 * classes
 * shedule
 * users
 * users_roles
 * roles
 * actions
 * actions_roles
 */

/**
 * –¢–∞–±–ª–∏—Ü–∞ 'gyms'
 * —Å–ø–æ—Ä—Ç–∑–∞–ª—ã
 */

DROP TABLE IF EXISTS gyms;

CREATE TABLE gyms (
  id SERIAL PRIMARY KEY,        -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–ø–æ—Ä—Ç–∑–∞–ª–∞                                         
  name varchar(150) NOT NULL,   -- –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–ø–æ—Ä—Ç–∑–∞–ª–∞
  about varchar(1000)           -- –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ø–æ—Ä—Ç–∑–∞–ª–∞
);

-- COPY gyms FROM '/home/user/gyms.txt';
INSERT INTO gyms (name, about) VALUES
  ('–°–†–¶ "–°–∏–Ω—è—è –ø—Ç–∏—Ü–∞"', 'https://vk.com/club43443915'),
  ('–§–∏—Ç–Ω–µ—Å –∫–ª—É–± "–û–ª–∏–º–ø–∏–∫ –•–æ–ª–ª"', 'https://vk.com/kostromaolympichall'),
  ('–ê—É—Ä–∞_–§–∏—Ç–Ω–µ—Å-–∫–ª—É–±_–ö–æ—Å—Ç—Ä–æ–º–∞', 'https://vk.com/aurakostroma'),
  ('–§–∏—Ç–Ω–µ—Å –∫–ª—É–± "–ê–ü–ï–õ–¨–°–ò–ù" –ö–æ—Å—Ç—Ä–æ–º–∞', 'https://vk.com/fc.apelsin');
  
SELECT * FROM gyms;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'news'
 * –Ω–æ–≤–æ—Å—Ç–∏ —Å–ø–æ—Ä—Ç–∑–∞–ª–æ–≤
 */

DROP TABLE IF EXISTS news;

CREATE TABLE news (
  gym_id integer REFERENCES gyms, -- —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–ø–æ—Ä—Ç–∑–∞–ª
  id SERIAL PRIMARY KEY,        -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–∏                                        
  title varchar(255) NOT NULL,  -- –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏                                       
  content varchar NOT NULL,     -- –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–æ–≤–æ—Å—Ç–∏
  publication date              -- –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–∏
);

-- COPY gyms FROM '/home/user/gyms.txt';
INSERT INTO news (gym_id, title, content, publication) VALUES
  (
    1,
    '–¢—Ä–µ–Ω–µ—Ä –¢–∞—Ç—å—è–Ω–∞ –ü—Ä—É—Å–∞–∫–æ–≤–∞ —Å–µ–≥–æ–¥–Ω—è –ø–æ–∫–∞–∑–∞–ª–∞ –∫–ª–∞—Å—Å, –≤—ã–ø–æ–ª–Ω—è—è —Å—Ç–æ–π–∫—É –≤ –ø–ª–∞–Ω–∫–µ!',
    '–í —ç—Ç–æ–º –º–µ—Å—è—Ü–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞ –¥–ª—è –∂–µ–Ω—â–∏–Ω - —Å—Ç–æ–π–∫–∞ –≤ –ø–ª–∞–Ω–∫–µ. –¢–∞—Ç—å—è–Ω–∞ –∑–∞–¥–∞–ª–∞ —Ç–æ–Ω –∏ –ø—Ä–æ—Å—Ç–æ—è–ª–∞ 10 –º–∏–Ω.20 —Å–µ–∫!...–ø–æ–∫–∞ —ç—Ç–æ –ª—É—á—à–µ–µ –≤—Ä–µ–º—è! –í–æ—Ç —ç—Ç–æ –º–æ—Ç–∏–≤–∞—Ü–∏—è!!!...–ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ —É—á–∞—Å—Ç–∏–µ! –°—Ç–∞–≤—å—Ç–µ —Ü–µ–ª–∏ –∏ –¥–æ–±–∏–≤–∞–π—Ç–µ—Å—å –∏—Ö!....',
    '2016-11-19'
  ),
  (
    2,
    '–¢—Ä–µ–Ω–µ—Ä –ö—É–∑–Ω–µ—Ü–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –ø—Ä–æ–≤–µ–ª —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ –æ—Ç–∂–∏–º–∞–Ω–∏—è–º –æ—Ç —É–ø–æ—Ä–æ–≤!',
    '–î–æ—Ä–æ–≥–∏–µ –¥—Ä—É–∑—å—è!!! –í –º–∏–Ω—É–≤—à–∏–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –≤ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–º –≥–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–µ "–î–µ–∫–∞—Ç–ª–æ–Ω" –ø—Ä–æ—à–ª–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ –æ—Ç–∂–∏–º–∞–Ω–∏—è–º –æ—Ç —É–ø–æ—Ä–æ–≤! –ü—Ä–æ–≤–æ–¥–∏–ª —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–µ—Ä –Ω–∞—à–µ–≥–æ –∫–ª—É–±–∞ –ö—É–∑–Ω–µ—Ü–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä! –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π!',
    '2016-11-28'
  );
  
SELECT * FROM news;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'classes'
 * –∑–∞–Ω—è—Ç–∏—è —Å–ø–æ—Ä—Ç–∑–∞–ª–æ–≤
 */
 
CREATE TYPE class_type AS ENUM ('class', 'event');

DROP TABLE IF EXISTS classes;

CREATE TABLE classes (
  id SERIAL PRIMARY KEY,                    -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–Ω—è—Ç–∏—è  
  gym_id integer REFERENCES gyms,           -- —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–ø–æ—Ä—Ç–∑–∞–ª  
  type class_type NOT NULL DEFAULT 'class', -- —Ç–∏–ø –∑–∞–Ω—è—Ç–∏—è                                   
  name varchar(300) NOT NULL,               -- –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è                                      
  description varchar(2000) NOT NULL,       -- –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è
  date varchar(150) NOT NULL,               -- –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è
  isactive boolean NOT NULL DEFAULT 'yes'   -- –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏—è
);

-- COPY gyms FROM '/home/user/gyms.txt';
INSERT INTO classes (gym_id, name, description, date, isactive, type) VALUES
  (
    1,
    '–ë–∞—Å—Å–µ–π–Ω',
    '–ö –≤–∞—à–∏–º —É—Å–ª—É–≥–∞–º —Ä–∞–±–æ—Ç–∞–µ—Ç –±–∞—Å—Å–µ–π–Ω —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞ –∏ –∑–∞–Ω—è—Ç–∏—è –ø–ª–∞–≤–∞–Ω–∏–µ–º. –ë–∞—Å—Å–µ–π–Ω 17—Ö6, –≥–ª—É–±–∏–Ω–∞ 1,60-1,30.',
    '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, —Å—Ä–µ–¥–∞, –ø—è—Ç–Ω–∏—Ü–∞ —Å 18:00 –¥–æ 20:00; —Å—É–±–±–æ—Ç–∞, –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ —Å 9:00 –¥–æ 15:00',
    'yes',
    'class'  
  ),
  (
    1,
    '–ê–∫–≤–∞-–∞—ç—Ä–æ–±–∏–∫–∞',
    '–ê–∫–≤–∞-–∞—ç—Ä–æ–±–∏–∫–∞ - —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–µ–π –∞—ç—Ä–æ–±–∏–∫–∏, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ –±–∞—Å—Å–µ–π–Ω–µ. –ù–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –º–æ–º–µ–Ω—Ç —ç—Ç–æ —Å–∞–º–æ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ, –ø–æ—Ö—É–¥–µ—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–µ–±—è –≤ —Ç–æ–Ω—É—Å–µ. –ê–∫–≤–∞-–∞—ç—Ä–æ–±–∏–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∞ –ª—é–¥—è–º –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤ –∏ –∫–æ–º–ø–ª–µ–∫—Ü–∏–π, –±–ª–∞–≥–æ–¥–∞—Ä—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –±–æ–ª—å—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π. –ì–ª–∞–≤–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è —ç—Ç–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ - –≤–æ–¥–∞ - —Å–æ–∑–¥–∞–µ—Ç –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏–π –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –ü—Ä–∏ —ç—Ç–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–∞–∫–æ–π –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –æ—Ä–≥–∞–Ω–∏–∑–º –∫–∞–∫ –ø—Ä–∏ –∑–∞–Ω—è—Ç–∏—è—Ö –Ω–∞ —Å—É—à–µ.',
    '–í—Ç–æ—Ä–Ω–∏–∫, —á–µ—Ç–≤–µ—Ä–≥ —Å 18:00 –¥–æ 20:00',
    'yes',
    'class'
  ),
  (
    1,
    '–¢—Ö—ç–∫–≤–æ–Ω–¥–æ',
    '–ó–∞–Ω—è—Ç–∏—è –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –∫–∞–∫ –æ–±—â–µ—Ä–∞–∑–≤–∏–≤–∞—é—â–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã, —Ç–∞–∫ –∏ –æ–±—É—á–µ–Ω–∏–µ —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –∫–∞–∫ –≤–æ—Å—Ç–æ—á–Ω–æ–º—É –µ–¥–∏–Ω–æ–±–æ—Ä—Å—Ç–≤—É (—Ç–µ—Ö–Ω–∏–∫–∞ –∏ —Ç–∞–∫—Ç–∏–∫–∞ –≤–µ–¥–µ–Ω–∏—è –ø–æ–µ–¥–∏–Ω–∫–∞, —Ç–µ—Ö–Ω–∏–∫–∞ —Å–∞–º–æ–∑–∞—â–∏—Ç—ã,–∏ –¥—Ä.).',
    '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —Å 18:00 –¥–æ 19:00; —Å—Ä–µ–¥–∞ —Å 18:30 –¥–æ 19:30; –ø—è—Ç–Ω–∏—Ü–∞ —Å 19:00 –¥–æ 20:00',
    'yes',
    'class'
  ),
  (
    1,
    '–¢–ê–ô-–ë–û',
    '–¢–∞–π-–±–æ ‚Äì –æ–¥–Ω–∞ –∏–∑ —Ñ–∏—Ç–Ω–µ—Å-—Å–∏—Å—Ç–µ–º, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å–ª–∏—Ç—ã –≤–æ–µ–¥–∏–Ω–æ –∑–∞–ø–∞–¥–Ω—ã–π –∏ –≤–æ—Å—Ç–æ—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏—é –æ—Ä–≥–∞–Ω–∏–∑–º–∞. –¢–∞–π-–±–æ ‚Äì —ç—Ç–æ —Å–∏–Ω—Ç–µ–∑ –∞—ç—Ä–æ–±–∏–∫–∏ –∏ –≤–æ—Å—Ç–æ—á–Ω—ã—Ö –µ–¥–∏–Ω–æ–±–æ—Ä—Å—Ç–≤. –ï—Å–ª–∏ –í–∞—Å –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–æ—Å—Ç–æ—á–Ω—ã–µ –µ–¥–∏–Ω–æ–±–æ—Ä—Å—Ç–≤–∞ –∏ –¥—Ä—É–≥–∏–µ –±–æ–µ–≤—ã–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞, —Ç–æ —Ç–∞–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –∫–∞–∫ —Ä–∞–∑ –¥–ª—è –í–∞—Å. –í —Ç–∞–π–±–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã —Ç–∞–∫–∏–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞, –∫–∞–∫ –±–æ–∫—Å, —Ç—Ö—ç–∫–≤–æ–Ω–¥–æ –∏ –∫–∞—Ä–∞—Ç–µ. –ö—Ä–æ–º–µ –Ω–∏—Ö –≤ —Ñ–∏—Ç–Ω–µ—Å-–ø—Ä–æ–≥—Ä–∞–º–º—É —Ç–∞–π–±–æ –≤–∫–ª—é—á–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã –∞—ç—Ä–æ–±–∏–∫–∏, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —ç—Ç–æ —à–∞–≥–∏, –∏ —Å–∏–ª–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.',
    '–í—Ç–æ—Ä–Ω–∏–∫ —Å 18:00 –¥–æ 19:00; —á–µ—Ç–≤–µ—Ä–≥ —Å 18:30 –¥–æ 19:30; —Å—É–±–±–æ—Ç–∞ —Å 10:00 –¥–æ 11:00',
    'no',
    'class'
  ),
  (
    1,
    '–û—Ç–∫—Ä—ã—Ç–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "–ö–∞–∫ –Ω–∞–∫–∞—á–∞—Ç—å —è–≥–æ–¥–∏—á–Ω—ã–µ –º—ã—à—Ü—ã"',
    '–ú–∏–ª—ã–µ –¥–µ–≤—É—à–∫–∏ –∏ –∂–µ–Ω—â–∏–Ω—ã!üå∑üëóüë†üëô 
–í —Ç—Ä–µ–Ω–∞–∂–µ—Ä–Ω–æ–º –∑–∞–ª–µ "–°–∏–Ω—è—è –ø—Ç–∏—Ü–∞" 1 –∞–ø—Ä–µ–ª—è –≤ 12-00 —Å–æ—Å—Ç–æ–∏—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞üí™üí™üí™
–í —Å–≤–µ—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –ø–ª—è–∂–Ω–æ–º—É —Å–µ–∑–æ–Ω—É, –º—ã –ø–æ—Å–≤—è—â–∞–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É —Ç–µ–º–µ"–∫–∞–∫ –Ω–∞–∫–∞—á–∞—Ç—å —è–≥–æ–¥–∏—á–Ω—ã–µ –º—ã—à—Ü—ã"üå∞üå∞üå∞
–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –ø—Ä–æ–≤–æ–¥–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ç—Ä–µ–Ω–∞–∂—ë—Ä–Ω–æ–≥–æ –∑–∞–ª–∞ –°–º–∏—Ä–Ω–æ–≤ –ê–Ω–∞—Ç–æ–ª–∏–π, –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è –Ω–æ–≥ –∏ —Ä–∞–∑–æ–±—Ä–∞–Ω—ã —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏!üí™üí™üí™
–í—ã –µ—â—ë –¥—É–º–∞–µ—Ç–µ –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å "–æ—Ä–µ—à–µ–∫" –∫ –ª–µ—Ç—É!üå∞üå∞üå∞–ù–µ –¥—É–º–∞–π—Ç–µ, –∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ!üëÄüëÄüëÄ–ñ–¥—ë–º –≤–∞—Å 1 –∞–ø—Ä–µ–ª—è –≤ 12-00 –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–Ω–æ–º –∑–∞–ª–µ "–°–∏–Ω—è—è –ø—Ç–∏—Ü–∞"!üí™üëç (2017/03/27 https://vk.com/wall-43443915_1953)',
    '1 –∞–ø—Ä–µ–ª—è 2017 –≤ 12:00',
    'yes',
    'event'
  ),
  (
    1,
    '–û—Ç–∫—Ä—ã—Ç–∞—è —Å–∏–ª–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å –î–∞—Ä—å–µ–π –ë—É—Ö–∞—Ä–µ–≤–æ–π –≤ —Ä–∞–º–∫–∞—Ö —Ñ–µ—Å—Ç–∏–≤–∞–ª—è —Å–ø–æ—Ä—Ç',
    '–í —Ä–∞–º–∫–∞—Ö —Ñ–µ—Å—Ç–∏–≤–∞–ª—è —Å–ø–æ—Ä—Ç–∞ –°–†–¶ "–°–∏–Ω—è—è –ø—Ç–∏—Ü–∞" –ø—Ä–æ–≤–æ–¥–∏—Ç –æ—Ç–∫—Ä—ã—Ç—É—é —Å–∏–ª–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É —Å –î–∞—Ä—å–µ–π –ë—É—Ö–∞—Ä–µ–≤–æ–π! –ú—ã –ø—Ä–∏–≥–ª–∞—à–∞–µ–º –≤—Å–µ—Ö –∂–µ–ª–∞—é—â–∏—Ö –∑–∞–≤—Ç—Ä–∞ –≤ —Å—É–±–±–æ—Ç—É 27 –∞–≤–≥—É—Å—Ç–∞ –Ω–∞ –ø–ª–æ—â–∞–¥–∫—É –¢–¶ "–≠–∫—Å–ø–æ—Å—Ç—Ä–æ–π". –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -12.20 —á–∞—Å. –ü—Ä–∏ —Å–µ–±–µ –∏–º–µ—Ç—å —Å–ø–æ—Ä—Ç–∏–≤–Ω—É—é —Ñ–æ—Ä–º—É –∏ —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!
–ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–æ–≥–æ–¥—ã -–ë–£–î–ï–¢ –ñ–ê–†–ö–û!!!üëçüí™üí™üí™ (26/08/2016 https://vk.com/wall-43443915_1133)',
    '27 –∞–≤–≥—É—Å—Ç–∞ 2016 –≤ 12:20',
    'no',
    'event'
  ),
  (
    3,
    '–°–∞–π–∫–ª: –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –≤ –¢–†–¶ –ö–æ–ª–ª–∞–∂',
    '–î—Ä—É–∑—å—è –≤—Å–µ –∫—Ç–æ –Ω–µ –ø—Ä–æ–±–æ–≤–∞–ª –°–∞–π–∫–ª –∏ —Ö–æ—á–µ—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–∞–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–∞–µ–º –≤ –ö–æ–ª–ª–∞–∂ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ- 16 –∏—é–ª—è –≤ 15-00.
"–ø—Ä–æ—Å—å–±–∞ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø–µ –¢—Ä—Ü –ö–æ–ª–ª–∞–∂" (16/07/2016 https://vk.com/wall-80272742_2107)',
    '16 –∏—é–ª—è 2016 –≤ 15:00',
    'no',
    'event'
  ),
  (
    4,
    '–û—Ç–∫—Ä—ã—Ç–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å –î–µ–Ω–∏—Å–æ–º –°–æ–∫–æ–≤—ã–º –ø–æ –∂–∏–º—É —à—Ç–∞–Ω–≥–∏ –ª–µ–∂–∞',
    '–î–æ—Ä–æ–≥–∏–µ –¥—Ä—É–∑—å—è, —Å–µ–≥–æ–¥–Ω—è —Å–æ—Å—Ç–æ–∏—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å –î–µ–Ω–∏—Å–æ–º –°–æ–∫–æ–≤—ã–º –ø–æ –∂–∏–º—É —à—Ç–∞–Ω–≥–∏ –ª–µ–∂–∞. –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–π–¥–µ—Ç –≤ —Ñ–∏—Ç–Ω–µ—Å-–∫–ª—É–±–µ "–ê–ø–µ–ª—å—Å–∏–Ω" –≤ 19.00. –ñ–¥–µ–º –≤—Å–µ—Ö –∂–µ–ª–∞—é—â–∏—Ö!üí™ –í—Ö–æ–¥ —Å–≤–æ–±–æ–¥–Ω—ã–π!!! (https://vk.com/wall-115625784_1279)',
    '22 –º–∞—Ä—Ç–∞ 2017 –≤ 19.00',
    'yes',
    'event'
  );
  
SELECT * FROM classes;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'schedule'
 * —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π
 */

DROP TABLE IF EXISTS schedule;

CREATE TABLE schedule (
  class_id integer REFERENCES classes,  -- —Å—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–Ω—è—Ç–∏–µ
  id SERIAL PRIMARY KEY,                -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏—è                                      
  begin_date date NOT NULL,             -- –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∑–∞–Ω—è—Ç–∏—è                                     
  begin_time time NOT NULL,             -- –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∑–∞–Ω—è—Ç–∏—è
  length interval NOT NULL DEFAULT '1 hours' -- –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–Ω—è—Ç–∏—è
);

-- COPY gyms FROM '/home/user/gyms.txt';
INSERT INTO schedule (class_id, begin_date, begin_time, length) VALUES
  (1,'2016-12-10', '18:00', '2 hours'), --mo
  (1,'2016-12-10', '18:00', '2 hours'), --we
  (1,'2016-12-10', '18:00', '2 hours'), --fr
  (1,'2016-12-10', '09:00', '6 hours'), --sa
  (1,'2016-12-11', '09:00', '6 hours'), --su
  (2,'2016-12-06', '18:00', '2 hours'), --tu
  (2,'2016-12-08', '18:00', '2 hours'), --th
  (3,'2016-12-05', '18:00', '1 hours'), --mo
  (3,'2016-12-07', '18:30', '1 hours'), --we
  (3,'2016-12-09', '19:00', '1 hours'), --fr
  (4,'2016-12-06', '18:00', '1 hours'), --tu
  (4,'2016-12-08', '18:30', '1 hours'), --th
  (4,'2016-12-10', '10:00', '1 hours'), --sa
  --events
  (5,'2017-04-01', '12:00', '2 hours'), 
  (6,'2016-08-27', '12:20', '2 hours'), 
  (7,'2016-07-16', '15:00', '2 hours'), 
  (8,'2017-03-22', '19:00', '2 hours'); 
  
SELECT * FROM schedule;
  
/**
 * –¢–∞–±–ª–∏—Ü–∞ 'users'
 * –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
 */

DROP TABLE IF EXISTS users;

CREATE TABLE users (
  id SERIAL PRIMARY KEY,            -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  name varchar(100) NOT NULL,       -- –§–ò –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  -- first_name varchar(50) NOT NULL,  -- –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è         
  -- last_name varchar(50) NOT NULL,   -- —Ñ–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  sex char(1),                      -- –ø–æ–ª: 'F' for female, 'M' for male
  birthday date,                    -- –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
  e_mail varchar(50) NOT NULL,      -- –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
  phone varchar(10),                -- —Ç–µ–ª–µ—Ñ–æ–Ω
  avatar varchar(100)               -- –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∞
);

-- COPY users FROM 'users.txt';
INSERT INTO users (birthday, e_mail, name) VALUES 
  ('1982-02-03', 'jjivjuthyid@xaker.ru', '–®–∞–ª–∏–º–æ–≤ –ò–≥–æ—Ä—å'),
  ('1993-04-23', 'ruchiashyich@usa.net', '–ö—É–ø—Ä–µ–≤–∏—á–∞ –û–ª—å–≥–∞'),
  ('1990-01-16', 'chehy@mail.ru', '–ö–∞—Å—å—è–Ω–µ–Ω–∫–æ –í–ª–∞–¥–∏–º–∏—Ä'),
  ('1982-11-05', 'routhe@softhome.com', '–ë–µ–ª–æ–≤–∞ –Æ–ª–∏—è'),
  ('1993-04-17', 'pyasy@umr.ru', '–ü—Ä–æ–Ω–∏–Ω –ï–≤–≥–µ–Ω–∏–π');
INSERT INTO users (birthday, e_mail, name, sex) VALUES 
  ('1982-09-01', 'nixu@email.ru', '–§–µ–¥—É–ª–æ–≤–∞ –û–∫—Å–∞–Ω–∞', 'F'),
  ('1992-11-05', 'shjivya@rol.ru', '–Ø–Ω—á—É—Ä–æ–≤ –î–º–∏—Ç—Ä–∏–π', 'M'),
  ('1981-10-19', 'xjuvyeziex@rin.ru', '–ü–æ–ª—É–Ω–∏–Ω–∞ –õ–∏–¥–∏—è', 'F'),
  ('1978-03-19', 'fjihyexio@email.ru', '–ö–æ–Ω—Ç–µ–µ–Ω–∫–æ –í–∞—Å–∏–ª–∏–π', 'M'),
  ('1984-10-15', 'shjiqu@land.ru', '–ù–∞—É–º–æ–≤–∞ –ö—Ä–∏—Å—Ç–∏–Ω–∞', 'F');
  
SELECT * FROM users;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'users_registered_on_classes'
 * –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏
 */

DROP TABLE IF EXISTS users_registered_on_classes;

CREATE TABLE users_registered_on_classes (
  user_id integer REFERENCES users,     -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                                     
  class_id integer REFERENCES classes   -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∞—Å—Å–∞
);

-- COPY gyms FROM 'actions.txt';
INSERT INTO users_registered_on_classes (user_id, class_id) VALUES
  (1,1), (2,2), (3,3), (4,4), (5,1), (6,2); 

SELECT * FROM users_registered_on_classes;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'roles'
 * —Ä–æ–ª–∏
 */

DROP TABLE IF EXISTS roles;

CREATE TABLE roles (
  id varchar(50) PRIMARY KEY UNIQUE NOT NULL    -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–ª–∏ - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
);

-- COPY gyms FROM 'roles.txt';
INSERT INTO roles (id) VALUES
  ('admin'),
  ('content_manager'),
  ('trainer');
  
SELECT * FROM roles;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'users_roles'
 * —Ä–æ–ª–∏, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
 */

DROP TABLE IF EXISTS users_roles;

CREATE TABLE users_roles (
  user_id integer REFERENCES users,  -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                                     
  role_id varchar(50) REFERENCES roles   -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–ª–∏
);

-- COPY gyms FROM 'actions.txt';
INSERT INTO users_roles (user_id, role_id) VALUES
  (1,'admin'),
  (2,'content_manager'),
  (3,'trainer'); 

SELECT * FROM users_roles;
  
  
/**
 * –¢–∞–±–ª–∏—Ü–∞ 'actions'
 * —Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
 */

DROP TABLE IF EXISTS actions;

CREATE TABLE actions (
  id varchar(50) PRIMARY KEY UNIQUE NOT NULL    -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–π - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
);

-- COPY gyms FROM 'actions.txt';
INSERT INTO actions (id) VALUES
  ('add_classes'),
  ('change_classes'),
  ('add_user'),
  ('change_user'),
  ('view_user'),
  ('add_news'),
  ('add_role'),
  ('change_role'),
  ('delete_role'),
  ('add_action'),
  ('change_action'),
  ('delete_action');
  
SELECT * FROM actions;


/**
 * –¢–∞–±–ª–∏—Ü–∞ 'actions_roles'
 * –¥–µ–π—Å—Ç–≤–∏—è, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏
 */

DROP TABLE IF EXISTS actions_roles;

CREATE TABLE actions_roles (
  action_id varchar(50) REFERENCES actions,  -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è                                    
  role_id varchar(50) REFERENCES roles       -- –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–ª–∏
);

-- COPY gyms FROM 'actions.txt';
INSERT INTO actions_roles (role_id, action_id) VALUES
  ('trainer', 'add_classes'),
  ('trainer', 'change_classes'),
  ('admin', 'add_user'),
  ('admin', 'change_user'),
  ('admin', 'view_user'),
  ('content_manager', 'add_news'),
  ('content_manager', 'add_role'),
  ('content_manager', 'change_role'),
  ('content_manager', 'delete_role'),
  ('admin', 'add_action'),
  ('admin', 'change_action'),
  ('admin', 'delete_action');
  
SELECT * FROM actions_roles;
